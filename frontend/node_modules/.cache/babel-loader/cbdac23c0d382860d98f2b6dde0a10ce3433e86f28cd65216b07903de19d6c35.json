{"ast":null,"code":"var _jsxFileName = \"/Users/ryantay/Desktop/Merctrans/pdf-reader/frontend/src/components/PDFViewer.js\",\n  _s = $RefreshSig$();\n// src/components/PDFViewer.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist';\n\n// Set worker path\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\npdfjsLib.GlobalWorkerOptions.workerSrc = \"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.9.155/build/pdf.worker.min.mjs\";\nconst PDFViewer = ({\n  url,\n  pageNumber,\n  onClose\n}) => {\n  _s();\n  const [error, setError] = useState(null);\n  const canvasRef = useRef(null);\n  const renderTaskRef = useRef(null);\n  useEffect(() => {\n    const loadPDF = async () => {\n      try {\n        // Cancel any existing render task\n        if (renderTaskRef.current) {\n          renderTaskRef.current.cancel();\n          renderTaskRef.current = null;\n        }\n\n        // Clear the canvas\n        const canvas = canvasRef.current;\n        const context = canvas.getContext('2d');\n        context.clearRect(0, 0, canvas.width, canvas.height);\n\n        // Load the PDF\n        const loadingTask = pdfjsLib.getDocument(url);\n        const pdf = await loadingTask.promise;\n\n        // Validate page number\n        const validPageNumber = Math.min(Math.max(1, pageNumber), pdf.numPages);\n        const page = await pdf.getPage(validPageNumber);\n        const viewport = page.getViewport({\n          scale: 1.5\n        });\n        canvas.height = viewport.height;\n        canvas.width = viewport.width;\n\n        // Store the render task\n        renderTaskRef.current = page.render({\n          canvasContext: context,\n          viewport: viewport\n        });\n        await renderTaskRef.current.promise;\n      } catch (err) {\n        if (err.name !== 'RenderingCancelled') {\n          console.error('Error loading PDF:', err);\n          setError('Error loading PDF page');\n        }\n      }\n    };\n    loadPDF();\n\n    // Cleanup function\n    return () => {\n      if (renderTaskRef.current) {\n        renderTaskRef.current.cancel();\n        renderTaskRef.current = null;\n      }\n    };\n  }, [url, pageNumber]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pdf-viewer-overlay\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pdf-viewer-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close-button\",\n        onClick: onClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this), error ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 7\n  }, this);\n};\n_s(PDFViewer, \"u7ukVT1ZdhjjJ5VfoZNRPkdhts8=\");\n_c = PDFViewer;\nexport default PDFViewer;\nvar _c;\n$RefreshReg$(_c, \"PDFViewer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","pdfjsLib","jsxDEV","_jsxDEV","GlobalWorkerOptions","workerSrc","PDFViewer","url","pageNumber","onClose","_s","error","setError","canvasRef","renderTaskRef","loadPDF","current","cancel","canvas","context","getContext","clearRect","width","height","loadingTask","getDocument","pdf","promise","validPageNumber","Math","min","max","numPages","page","getPage","viewport","getViewport","scale","render","canvasContext","err","name","console","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","_c","$RefreshReg$"],"sources":["/Users/ryantay/Desktop/Merctrans/pdf-reader/frontend/src/components/PDFViewer.js"],"sourcesContent":["// src/components/PDFViewer.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist';\n\n// Set worker path\npdfjsLib.GlobalWorkerOptions.workerSrc = \"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.9.155/build/pdf.worker.min.mjs\"; \n\nconst PDFViewer = ({ url, pageNumber, onClose }) => {\n    const [error, setError] = useState(null);\n    const canvasRef = useRef(null);\n    const renderTaskRef = useRef(null);\n  \n    useEffect(() => {\n      const loadPDF = async () => {\n        try {\n          // Cancel any existing render task\n          if (renderTaskRef.current) {\n            renderTaskRef.current.cancel();\n            renderTaskRef.current = null;\n          }\n  \n          // Clear the canvas\n          const canvas = canvasRef.current;\n          const context = canvas.getContext('2d');\n          context.clearRect(0, 0, canvas.width, canvas.height);\n  \n          // Load the PDF\n          const loadingTask = pdfjsLib.getDocument(url);\n          const pdf = await loadingTask.promise;\n  \n          // Validate page number\n          const validPageNumber = Math.min(Math.max(1, pageNumber), pdf.numPages);\n          const page = await pdf.getPage(validPageNumber);\n          \n          const viewport = page.getViewport({ scale: 1.5 });\n          canvas.height = viewport.height;\n          canvas.width = viewport.width;\n  \n          // Store the render task\n          renderTaskRef.current = page.render({\n            canvasContext: context,\n            viewport: viewport\n          });\n  \n          await renderTaskRef.current.promise;\n        } catch (err) {\n          if (err.name !== 'RenderingCancelled') {\n            console.error('Error loading PDF:', err);\n            setError('Error loading PDF page');\n          }\n        }\n      };\n  \n      loadPDF();\n  \n      // Cleanup function\n      return () => {\n        if (renderTaskRef.current) {\n          renderTaskRef.current.cancel();\n          renderTaskRef.current = null;\n        }\n      };\n    }, [url, pageNumber]);\n  \n    return (\n      <div className=\"pdf-viewer-overlay\">\n        <div className=\"pdf-viewer-content\">\n          <button className=\"close-button\" onClick={onClose}>Ã—</button>\n          {error ? (\n            <div className=\"error-message\">{error}</div>\n          ) : (\n            <canvas ref={canvasRef}></canvas>\n          )}\n        </div>\n      </div>\n    );\n  };\n  \n  export default PDFViewer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}